clc
clear all
close all
A=[0.320256307610174  -0.296399796890738
   0.240192230707631  -0.113413889435408
   0.253184841770917   0.008971126120922
   0.196116135138184  -0.115127575965352
   0.138675049056307  -0.267171697467897
   0.160128153805087  -0.346387356015310
   0.160128153805087  -0.346387356015310
   0.160128153805087  -0.089929306851041
   0.179028718509858   0.052829638656670
   0.113227703414460   0.055634062607375
   0.138675049056307  -0.267171697467897
   0.080064076902544  -0.085395397333461
   0.113227703414460  -0.098684239252480
   0.179028718509858  -0.046711251484919
   0.113227703414460   0.112515083137803
   0.113227703414460   0.112515083137803
   0.113227703414460  -0.282269260974726
   0.113227703414460  -0.091190461416139
   0.113227703414460   0.112515083137803
   0.138675049056307  -0.030919247283062
   0.113227703414460   0.112515083137803
   0.113227703414460  -0.091190461416139
   0.113227703414460   0.112515083137803
   0.179028718509858   0.196022875540765
   0.138675049056307   0.135441149306105
   0.138675049056307   0.145155351901597
   0.113227703414460   0.127484655103137
   0.160128153805087   0.134911304227594
   0.138675049056307   0.080223240080629
   0.160128153805087   0.182017069461423
   0.160128153805087   0.071390277947330
   0.196116135138184   0.128108134204571
   0.277350098112615   0.251627460248108
   0.330112645886762   0.269793542257147];
X=A;
%用kmeans算法确定最佳聚类数目
numc=6;
silh_m=zeros(1,numc);
for i=1:numc    
    kidx=kmeans(X,i);    
    silh=silhouette(X,kidx);%计算轮廓系数
    silh_m(i)=mean(silh);
end
figure
plot(1:numc,silh_m,'o-')
xlabel('类别数');
ylabel('平均轮廓系数');
title('不同类别对应的平均轮廓系数');

%绘制2至5类时的平均值分布图
figure
for i=2:5   
    kidx=kmeans(X,i);    
    subplot(2,2,i-1);   
    [~,h]=silhouette(X,kidx);%画出轮廓系数  
    title([num2str(i),'类时的轮廓系数']);   
    snapnow
    xlabel('轮廓系数');   
    ylabel('类别数');
end
%kmeans聚类过程，并将结果显示
[idx,ctr]=kmeans(X,4);
figure
F1=plot(find(idx==1),A(idx==1),'r--*',...  
    find(idx==2),A(idx==2),'b:o',...   
    find(idx==3),A(idx==3),'k:o',...   
    find(idx==4),A(idx==4),'g:d');
set(gca,'linewidth',2);
set(F1,'linewidth',2,'MarkerSize',8);
xlabel('编号');
ylabel('得分');
title('聚类结果');
%层次聚类的聚类过程
Y=pdist(X);%计算样本点间的欧式距离
Z=linkage(Y,'average');
cn=size(X);
clabel=1:cn;
clabel=clabel';
figure
F2=dendrogram(Z);
title('层次聚类法聚类结果');
set(F2,'linewidth',2);
ylabel('标准距离');
